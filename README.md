# ZorgenBot: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Telegram-–±–æ—Ç —Å –ª–æ–∫–∞–ª—å–Ω–æ–π LLM –∏ —Å–∏—Å—Ç–µ–º–æ–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –±–æ—Ç –¥–ª—è Telegram, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –ª–æ–∫–∞–ª—å–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—É—é —è–∑—ã–∫–æ–≤—É—é –º–æ–¥–µ–ª—å (Llama 2, Mistral, Phi-3 –∏ —Ç.–¥.) —á–µ—Ä–µ–∑ OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π API. –ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Å–ª–æ–∂–Ω—É—é —Å–∏—Å—Ç–µ–º—É –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.

## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ö–ª—é—á–µ–≤—ã–µ –ú–µ—Ö–∞–Ω–∏–∑–º—ã

### –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∂–¥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –∫–æ–Ω–≤–µ–π–µ—Ä –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π:

1.  **–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ (`analyze_priority`):** –ú–æ–¥–µ–ª—å LLM –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –≤—Ö–æ–¥—è—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ —à–∫–∞–ª–µ –æ—Ç 1 (–°—Ä–æ—á–Ω–æ) –¥–æ 4 (–ë–µ–∑–æ—Ç–≤–µ—Ç–Ω–æ) –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –≤–∞–∂–Ω–æ—Å—Ç–∏.
2.  **–ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è (`make_decision`):** –ù–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞, —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–∏–∞–ª–æ–≥–∞ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–æ—Ç–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è —Ä–µ—à–µ–Ω–∏–µ: –æ—Ç–≤–µ—Ç–∏—Ç—å (`–î–ê`), –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å (`–ù–ï–¢`) –∏–ª–∏ –ø—Ä–æ—è–≤–∏—Ç—å –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É (`–ò–ù–ò–¶–ò–ê–¢–ò–í–ê`).
3.  **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ (`generate_response_text`):** –ï—Å–ª–∏ —Ä–µ—à–µ–Ω–∏–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è contextual –æ—Ç–≤–µ—Ç, —É—á–∏—Ç—ã–≤–∞—é—â–∏–π –≤—Å–µ –≤—ã—à–µ–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã.

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏ –ø–∞–º—è—Ç—å—é

*   **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:** –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞—Ç–∞ (`user_context`) —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–º OpenAI Chat Completion, –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ JSON-—Ñ–∞–π–ª—ã.
*   **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è:** –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–æ—Ç–∞ (`bot_state`), –≤–∫–ª—é—á–∞—è –µ–≥–æ "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ" –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ "–º—ã—Å–ª–∏", –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏.
*   **–ú–µ—Ö–∞–Ω–∏–∑–º offset:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (`last_offset.txt`) –¥–ª—è —É—Å—Ç–æ–π—á–∏–≤–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ.

### –§–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

–ó–∞–ø—É—â–µ–Ω —Ñ–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å (`thinking_loop`), –∫–æ—Ç–æ—Ä—ã–π –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏, –≥–µ–Ω–µ—Ä–∏—Ä—É—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ "—Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è" –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å —Å–æ–∑–Ω–∞–Ω–∏—è –±–æ—Ç–∞.

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

*   **–Ø–∑—ã–∫:** Python 3.10+
*   **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å:** `asyncio`
*   **–§—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Telegram:** `aiogram`
*   **LLM API:** `openai` (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏: KoboldCpp, Text Generation WebUI)
*   **–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:** JSON
*   **–ú–æ–¥–µ–ª–∏:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–Ω—ã–º–∏ 7B-–º–æ–¥–µ–ª—è–º–∏ (GGUF), —Ç–∞–∫–∏–º–∏ –∫–∞–∫ `Mistral-7B-Instruct-v0.2`, `Phi-3-mini`.

## ‚öôÔ∏è –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

1.  –ë–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ Telegram-—á–∞—Ç–∞.
2.  –°–æ–æ–±—â–µ–Ω–∏–µ –æ—á–∏—â–∞–µ—Ç—Å—è –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –ø—É—Å—Ç–æ—Ç—É.
3.  –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–æ–Ω–≤–µ–π–µ—Ä LLM-–∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.
4.  –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è, –∏–º–∏—Ç–∏—Ä—É—è "–∑–∞–¥–µ—Ä–∂–∫—É –Ω–∞ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–µ".
5.  –ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –æ—Ç–≤–µ—Ç–∞ –≤ —á–∞—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å "–ø–µ—á–∞—Ç–∞–µ—Ç...".
6.  –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–∏–∞–ª–æ–≥–∞ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–æ—Ç–∞ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.


## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
    ```bash
    pip install aiogram openai
    ```

2.  **–†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω—É—é LLM:** –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, `KoboldCpp` –∏–ª–∏ `llama.cpp`) —Å OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º API –Ω–∞ `http://localhost:5001/v1`.

3.  **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–æ—Ç–∞:**
    *   –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω —É `@BotFather` –∏ —É–∫–∞–∂–∏—Ç–µ –µ–≥–æ –≤ `TELEGRAM_TOKEN`.
    *   –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–∏—Ç–µ `OPENAI_BASE_URL` –∏ `MODEL_NAME` –≤ –∫–æ–¥–µ.

4.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:**
    ```bash
    python main.py
    ```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞ `main.py`:

```python
TELEGRAM_TOKEN = "your_telegram_bot_token"    <–¢–µ–ª–µ–≥—Ä–∞–º —Ç–æ–∫–µ–Ω –Ω–µ–π—Ä–æ–±–æ—Ç–∞>
OPENAI_BASE_URL = "http://localhost:5001/v1"  <–ê–¥—Ä–µ—Å OpenAI —Å–æ–≤–º–µ—Å—Ç–∏–º–æ–≥–æ API>
MODEL_NAME = "llama-2-7b-chat.Q8_0" ¬† ¬† ¬† ¬†   <–ù–∞–∑–≤–∞–Ω–∏–µ LLM –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ>
BOT_NAMES = ["–ó–æ—Ä–≥–µ–Ω", "–∑–æ—Ä–≥–µ–Ω", "Zorgen"] ¬†  <–¢—Ä–∏–≥–≥–µ—Ä—ã —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –±–æ—Ç–∞>
MEMORY_DIR = "memory" ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† <–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø–∞–º—è—Ç–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –±–æ—Ç–∞>
```
## ‚ö†Ô∏è –í–ê–ñ–ù–û!

–í –∫–æ–¥–µ —É–∂–µ –µ—Å—Ç—å –ª–∏—á–Ω–æ—Å—Ç—å –Ω–µ–π—Ä–æ–±–æ—Ç–∞ Zorgen (–ó–æ—Ä–≥–µ–Ω), –∏ –±–æ—Ç –±—É–¥–µ—Ç –æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —ç—Ç–∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã –¥–æ –≤–∞—à–µ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞





